<html>

<head>
<style type="text/css">
.inline {
  background-color: #f7f7f7;
  border:solid 1px #B0B0B0;
}
.error {
	font-weight: bold;
	color: #FF0000;
}
.warning {
	font-weight: bold;
}
.message {
	font-style: italic;
}
.source, .output, .warning, .error, .message {
	padding: 0 1em;
  border:solid 1px #F7F7F7;
}
.source {
  background-color: #f5f5f5;
}
.left {
  text-align: left;
}
.right {
  text-align: right;
}
.center {
  text-align: center;
}
.hl.num {
  color: #AF0F91;
}
.hl.str {
  color: #317ECC;
}
.hl.com {
  color: #AD95AF;
  font-style: italic;
}
.hl.opt {
  color: #000000;
}
.hl.std {
  color: #585858;
}
.hl.kwa {
  color: #295F94;
  font-weight: bold;
}
.hl.kwb {
  color: #B05A65;
}
.hl.kwc {
  color: #55aa55;
}
.hl.kwd {
  color: #BC5A65;
  font-weight: bold;
}
</style>
<title>Looking at the online black market in World of Warcraft</title>
</head>

<h1>
World of Warcraft and the online black market, part 2.
</h1>

<body>
Playing off the last document, we will be using some time-series forecasting packages in R to see if we are able to predict gold prices in World of Warcraft. We are not using token prices but the historical black market prices. Starting from our orignal dataset we need to isolate just those and run some time-series packages on them.

<div class="chunk" id="unnamed-chunk-1"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com">#using packages</span>
<span class="hl kwd">library</span><span class="hl std">(ggplot2,</span> <span class="hl kwc">quietly</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">)</span>
<span class="hl kwd">library</span><span class="hl std">(scales,</span> <span class="hl kwc">quietly</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">)</span>
<span class="hl kwd">library</span><span class="hl std">(zoo,</span> <span class="hl kwc">quietly</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">)</span>
<span class="hl kwd">library</span><span class="hl std">(readstata13,</span> <span class="hl kwc">quietly</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">)</span>
<span class="hl kwd">library</span><span class="hl std">(haven,</span> <span class="hl kwc">quietly</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">)</span>
<span class="hl kwd">library</span><span class="hl std">(forecast,</span> <span class="hl kwc">quietly</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">)</span>
<span class="hl kwd">library</span><span class="hl std">(prophet,</span> <span class="hl kwc">quietly</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">)</span>
<span class="hl com">#looking into ets, tbats, and auto arima</span>
<span class="hl std">blackMarket</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">subset</span><span class="hl std">(wowgold, region</span><span class="hl opt">==</span><span class="hl str">&quot;Wow&quot;</span><span class="hl std">)</span>
<span class="hl com">#we have some missing values and need to do some imputation to fill them up for time series. I gathered the data and have no idea why </span>
<span class="hl com">#some of the values are missing therefore im going un the asumption they are randomly missing and not some bias</span>

<span class="hl kwd">library</span><span class="hl std">(mice,</span> <span class="hl kwc">quietly</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">)</span>
<span class="hl kwd">md.pattern</span><span class="hl std">(blackMarket,</span> <span class="hl kwc">plot</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">)</span>
</pre></div>
<div class="output"><pre class="knitr r">##     region Month Year date time rtime releasedatecata releasedatemop
## 104      1     1    1    1    1     1               1              1
## 16       1     1    1    1    1     1               1              1
##          0     0    0    0    0     0               0              0
##     releasedatedra releasedatelegi releasedatebfa releasedategold usdtog
## 104              1               1              1               1      1
## 16               1               1              1               1      0
##                  0               0              0               0     16
##     gtousd   
## 104      1  0
## 16       0  2
##         16 32
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">#we are missing 16 values for our gold to usd ratios</span>
<span class="hl com">#m is the number of imputations, maxit is iterations, meth is the  type of method you want to use to find the values </span>
<span class="hl com">#with pmm being predictive  mean matching</span>

<span class="hl std">tempData</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">mice</span><span class="hl std">(blackMarket,</span><span class="hl kwc">m</span><span class="hl std">=</span><span class="hl num">5</span><span class="hl std">,</span><span class="hl kwc">maxit</span><span class="hl std">=</span><span class="hl num">50</span><span class="hl std">,</span><span class="hl kwc">meth</span><span class="hl std">=</span><span class="hl str">'pmm'</span><span class="hl std">,</span><span class="hl kwc">seed</span><span class="hl std">=</span><span class="hl num">1337</span><span class="hl std">,</span>  <span class="hl kwc">print</span><span class="hl std">=</span><span class="hl num">FALSE</span><span class="hl std">)</span>
</pre></div>
<div class="warning"><pre class="knitr r">## Warning: Number of logged events: 509
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">#summary(tempData)</span>
<span class="hl std">completedBlack</span><span class="hl kwb">&lt;-</span><span class="hl kwd">complete</span><span class="hl std">(tempData,</span><span class="hl num">1</span><span class="hl std">)</span>

<span class="hl std">trainBlack</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">head</span><span class="hl std">(completedBlack,</span><span class="hl opt">-</span><span class="hl num">3</span><span class="hl std">)</span>
<span class="hl std">testBlack</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">tail</span><span class="hl std">(completedBlack,</span> <span class="hl num">3</span><span class="hl std">)</span>
</pre></div>
</div></div>

<p>Now that we have our testing and training sets determined we can no start comparing forecasting techniques. The first 3 techniques all come from the Forecasting package by Hyndman.</p>

<div class="chunk" id="unnamed-chunk-2"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com">##forecast package</span>

<span class="hl std">arimaGold</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">auto.arima</span><span class="hl std">(trainBlack</span><span class="hl opt">$</span><span class="hl std">gtousd)</span>
<span class="hl std">fcastarimagold</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">forecast</span><span class="hl std">(arimaGold,</span> <span class="hl kwc">h</span><span class="hl std">=</span> <span class="hl num">3</span><span class="hl std">)</span>
<span class="hl com">#plot(fcastarimagold)</span>

<span class="hl std">etsGold</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">ets</span><span class="hl std">(trainBlack</span><span class="hl opt">$</span><span class="hl std">gtousd)</span>
<span class="hl std">fcastetsgold</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">forecast</span><span class="hl std">(etsGold,</span> <span class="hl kwc">h</span><span class="hl std">=</span><span class="hl num">3</span><span class="hl std">)</span>
<span class="hl com">#plot(fcastetsgold)</span>

<span class="hl std">tbatsGold</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">tbats</span><span class="hl std">(trainBlack</span><span class="hl opt">$</span><span class="hl std">gtousd)</span>
<span class="hl std">fcasttbatsgold</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">forecast</span><span class="hl std">(tbatsGold,</span> <span class="hl kwc">h</span><span class="hl std">=</span><span class="hl num">3</span><span class="hl std">)</span>
<span class="hl com">#plot(fcasttbatsgold)</span>
</pre></div>
</div></div>

<p>This next technique comes from our boy Zuckerberg over at Facebook. They have developed a rather intresting time-series package called prophet. It is very simple to use, the only part that is annoying is having to rename the date and data columns to ds and y respectivley.</p>

<div class="chunk" id="unnamed-chunk-3"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com">##prophet</span>
<span class="hl com">#prophet does its own imputations reverting back to orginal data</span>
<span class="hl std">prophetBlack</span> <span class="hl kwb">&lt;-</span> <span class="hl std">completedBlack</span>
<span class="hl std">prophetBlack</span> <span class="hl kwb">&lt;-</span> <span class="hl std">prophetBlack[</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">7</span><span class="hl opt">:</span><span class="hl num">8</span><span class="hl std">)]</span>

<span class="hl com">#have to change names for prophet package</span>
<span class="hl kwd">library</span><span class="hl std">(tidyverse,</span> <span class="hl kwc">quietly</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">)</span>
<span class="hl std">prophetBlack</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">rename</span><span class="hl std">(prophetBlack,</span> <span class="hl kwc">ds</span> <span class="hl std">= rtime,</span> <span class="hl kwc">y</span> <span class="hl std">= gtousd)</span>
<span class="hl std">pBlack</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">prophet</span><span class="hl std">(prophetBlack)</span>
<span class="hl std">fprophet</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">make_future_dataframe</span><span class="hl std">(pBlack,</span> <span class="hl kwc">periods</span> <span class="hl std">=</span> <span class="hl num">3</span><span class="hl std">,</span> <span class="hl kwc">freq</span> <span class="hl std">=</span> <span class="hl str">&quot;month&quot;</span><span class="hl std">)</span>
<span class="hl std">fcastprophet</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">predict</span><span class="hl std">(pBlack, fprophet)</span>
<span class="hl kwd">plot</span><span class="hl std">(pBlack, fcastprophet)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/unnamed-chunk-3-1.png" title="plot of chunk unnamed-chunk-3" alt="plot of chunk unnamed-chunk-3" class="plot" /></div></div>

<p>Next, we are going to look at another one of Hyndman's packages called forecasthybrid which combines exponential smoothing, arima, tbats, STLM, neural net, theif, and a naive forecast. You can use equal weights for all those or make a vector that you set to determine the best weights. You can also use in-sample errors to do it as well.  </p>

<div class="chunk" id="unnamed-chunk-4"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com">##forecasthybrid</span>
<span class="hl kwd">library</span><span class="hl std">(forecastHybrid,</span> <span class="hl kwc">quietly</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">)</span>
<span class="hl std">hybridblack</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">hybridModel</span><span class="hl std">(trainBlack</span><span class="hl opt">$</span><span class="hl std">gtousd)</span>
</pre></div>
<div class="warning"><pre class="knitr r">## Warning in removeModels(y = y, models = expandedModels): The stlm model
## requires that the input data be a seasonal ts object. The stlm model will
## not be used.
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">blackfcast</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">forecast</span><span class="hl std">(hybridblack,</span> <span class="hl kwc">h</span><span class="hl std">=</span><span class="hl num">3</span><span class="hl std">)</span>
<span class="hl com">#plot(blackfcast)</span>

<span class="hl std">hybridblack1</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">hybridModel</span><span class="hl std">(completedBlack</span><span class="hl opt">$</span><span class="hl std">gtousd,</span> <span class="hl kwc">weights</span> <span class="hl std">=</span> <span class="hl str">&quot;insample.errors&quot;</span><span class="hl std">)</span>
</pre></div>
<div class="warning"><pre class="knitr r">## Warning in hybridModel(completedBlack$gtousd, weights = &quot;insample.errors&quot;):
## Using insample.error weights is not recommended for accuracy and may be
## deprecated in the future.

## Warning in hybridModel(completedBlack$gtousd, weights = &quot;insample.errors&quot;):
## The stlm model requires that the input data be a seasonal ts object. The
## stlm model will not be used.
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">blackfcast1</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">forecast</span><span class="hl std">(hybridblack1,</span> <span class="hl kwc">h</span><span class="hl std">=</span><span class="hl num">3</span><span class="hl std">)</span>
<span class="hl com">#plot(blackfcast1)</span>
</pre></div>
</div></div>


<p>Now that we have all of the forecasts we want to compare, we need to see the error metrics of each of them to deterime which one is the most accurate. </p>


<div class="chunk" id="unnamed-chunk-5"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com">#now we can look at all the forecasts and compare metrics to them all</span>

<span class="hl std">actVsFcast</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">cbind</span><span class="hl std">(</span><span class="hl kwd">ts</span><span class="hl std">(completedBlack</span><span class="hl opt">$</span><span class="hl std">gtousd),</span> <span class="hl kwd">ts</span><span class="hl std">(fcastetsgold</span><span class="hl opt">$</span><span class="hl std">mean,</span> <span class="hl kwc">start</span> <span class="hl std">=</span> <span class="hl num">117</span><span class="hl std">),</span> <span class="hl kwd">ts</span><span class="hl std">(fcastarimagold</span><span class="hl opt">$</span><span class="hl std">mean,</span> <span class="hl kwc">start</span> <span class="hl std">=</span> <span class="hl num">117</span><span class="hl std">),</span> <span class="hl kwd">ts</span><span class="hl std">(fcasttbatsgold</span><span class="hl opt">$</span><span class="hl std">mean,</span> <span class="hl kwc">start</span> <span class="hl std">=</span> <span class="hl num">117</span><span class="hl std">),</span> <span class="hl kwd">ts</span><span class="hl std">(</span><span class="hl kwd">tail</span><span class="hl std">(fcastprophet</span><span class="hl opt">$</span><span class="hl std">yhat,</span><span class="hl num">3</span><span class="hl std">),</span> <span class="hl kwc">start</span> <span class="hl std">=</span> <span class="hl num">117</span><span class="hl std">),</span> <span class="hl kwd">ts</span><span class="hl std">(blackfcast</span><span class="hl opt">$</span><span class="hl std">mean,</span> <span class="hl kwc">start</span> <span class="hl std">=</span> <span class="hl num">117</span><span class="hl std">),</span> <span class="hl kwd">ts</span><span class="hl std">(blackfcast1</span><span class="hl opt">$</span><span class="hl std">mean,</span> <span class="hl kwc">start</span> <span class="hl std">=</span> <span class="hl num">117</span><span class="hl std">))</span>
<span class="hl kwd">colnames</span><span class="hl std">(actVsFcast)</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Orignal&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;ETS&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;Arima&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;Tbats&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;Prophet&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;HybridE&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;HybridIn&quot;</span><span class="hl std">)</span>
<span class="hl kwd">autoplot</span><span class="hl std">(actVsFcast)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/unnamed-chunk-5-1.png" title="plot of chunk unnamed-chunk-5" alt="plot of chunk unnamed-chunk-5" class="plot" /></div></div>

<p>Suprisingly, facebooks package is off by a fair bit, around 4% with MAPE. It looks like their impution method is rather off as opposed to the mice packages. It will be intresting to see if this stays the same when looking at wowtoken prices.

<div class="chunk" id="unnamed-chunk-6"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com">#lets look at the metrics of our forecasted values</span>
<span class="hl kwd">library</span><span class="hl std">(Metrics,</span> <span class="hl kwc">quietly</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">)</span>

<span class="hl std">ETS</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">rbind</span><span class="hl std">(</span><span class="hl kwd">mape</span><span class="hl std">(testBlack</span><span class="hl opt">$</span><span class="hl std">gtousd,fcastetsgold</span><span class="hl opt">$</span><span class="hl std">mean),</span> <span class="hl kwd">rmse</span><span class="hl std">(testBlack</span><span class="hl opt">$</span><span class="hl std">gtousd, fcastetsgold</span><span class="hl opt">$</span><span class="hl std">mean),</span> <span class="hl kwd">mse</span><span class="hl std">(testBlack</span><span class="hl opt">$</span><span class="hl std">gtousd, fcastetsgold</span><span class="hl opt">$</span><span class="hl std">mean))</span>
<span class="hl std">ARIMA</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">rbind</span><span class="hl std">(</span><span class="hl kwd">mape</span><span class="hl std">(testBlack</span><span class="hl opt">$</span><span class="hl std">gtousd,fcastarimagold</span><span class="hl opt">$</span><span class="hl std">mean),</span> <span class="hl kwd">rmse</span><span class="hl std">(testBlack</span><span class="hl opt">$</span><span class="hl std">gtousd, fcastarimagold</span><span class="hl opt">$</span><span class="hl std">mean),</span> <span class="hl kwd">mse</span><span class="hl std">(testBlack</span><span class="hl opt">$</span><span class="hl std">gtousd, fcastarimagold</span><span class="hl opt">$</span><span class="hl std">mean))</span>
<span class="hl std">TBATS</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">rbind</span><span class="hl std">(</span><span class="hl kwd">mape</span><span class="hl std">(testBlack</span><span class="hl opt">$</span><span class="hl std">gtousd,fcasttbatsgold</span><span class="hl opt">$</span><span class="hl std">mean),</span> <span class="hl kwd">rmse</span><span class="hl std">(testBlack</span><span class="hl opt">$</span><span class="hl std">gtousd, fcasttbatsgold</span><span class="hl opt">$</span><span class="hl std">mean),</span> <span class="hl kwd">mse</span><span class="hl std">(testBlack</span><span class="hl opt">$</span><span class="hl std">gtousd, fcasttbatsgold</span><span class="hl opt">$</span><span class="hl std">mean))</span>
<span class="hl std">PROPHET</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">rbind</span><span class="hl std">(</span><span class="hl kwd">mape</span><span class="hl std">(testBlack</span><span class="hl opt">$</span><span class="hl std">gtousd,</span><span class="hl kwd">tail</span><span class="hl std">(fcastprophet</span><span class="hl opt">$</span><span class="hl std">yhat,</span><span class="hl num">3</span><span class="hl std">)),</span> <span class="hl kwd">rmse</span><span class="hl std">(testBlack</span><span class="hl opt">$</span><span class="hl std">gtousd,</span> <span class="hl kwd">tail</span><span class="hl std">(fcastprophet</span><span class="hl opt">$</span><span class="hl std">yhat,</span><span class="hl num">3</span><span class="hl std">)),</span> <span class="hl kwd">mse</span><span class="hl std">(testBlack</span><span class="hl opt">$</span><span class="hl std">gtousd,</span> <span class="hl kwd">tail</span><span class="hl std">(fcastprophet</span><span class="hl opt">$</span><span class="hl std">yhat,</span><span class="hl num">3</span><span class="hl std">)))</span>
<span class="hl std">HYBRIDE</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">rbind</span><span class="hl std">(</span><span class="hl kwd">mape</span><span class="hl std">(testBlack</span><span class="hl opt">$</span><span class="hl std">gtousd,blackfcast</span><span class="hl opt">$</span><span class="hl std">mean),</span> <span class="hl kwd">rmse</span><span class="hl std">(testBlack</span><span class="hl opt">$</span><span class="hl std">gtousd, blackfcast</span><span class="hl opt">$</span><span class="hl std">mean),</span> <span class="hl kwd">mse</span><span class="hl std">(testBlack</span><span class="hl opt">$</span><span class="hl std">gtousd, blackfcast</span><span class="hl opt">$</span><span class="hl std">mean))</span>
<span class="hl std">HYBRIDIN</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">rbind</span><span class="hl std">(</span><span class="hl kwd">mape</span><span class="hl std">(testBlack</span><span class="hl opt">$</span><span class="hl std">gtousd,blackfcast1</span><span class="hl opt">$</span><span class="hl std">mean),</span> <span class="hl kwd">rmse</span><span class="hl std">(testBlack</span><span class="hl opt">$</span><span class="hl std">gtousd, blackfcast1</span><span class="hl opt">$</span><span class="hl std">mean),</span> <span class="hl kwd">mse</span><span class="hl std">(testBlack</span><span class="hl opt">$</span><span class="hl std">gtousd, blackfcast1</span><span class="hl opt">$</span><span class="hl std">mean))</span>

<span class="hl std">error_metrics</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">cbind</span><span class="hl std">(ETS, ARIMA, TBATS, PROPHET, HYBRIDE, HYBRIDIN)</span>
<span class="hl kwd">colnames</span><span class="hl std">(error_metrics)</span> <span class="hl kwb">&lt;-</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;ETS&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;Arima&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;Tbats&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;Prophet&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;HybridE&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;HybridIn&quot;</span><span class="hl std">)</span>
<span class="hl std">error_metrics</span>
</pre></div>
<div class="output"><pre class="knitr r">##               ETS        Arima       Tbats    Prophet      HybridE
## [1,] 0.0043660597 0.0032301532 0.011666745 0.04408857 0.0056646069
## [2,] 0.0211839256 0.0130772015 0.046330561 0.18052067 0.0242256639
## [3,] 0.0004487587 0.0001710132 0.002146521 0.03258771 0.0005868828
##          HybridIn
## [1,] 0.0024083682
## [2,] 0.0133860867
## [3,] 0.0001791873
</pre></div>
</div></div>

<p> Looking at the tablee we see that hybridmodel() with in-sample errors choosing the weights is the most accurate base off all of our error metrics. Let's plot the original data vs the most precise forecast to see how close we got. </p>

<div class="chunk" id="unnamed-chunk-7"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl std">most_precise</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">cbind</span><span class="hl std">(</span><span class="hl kwd">ts</span><span class="hl std">(completedBlack</span><span class="hl opt">$</span><span class="hl std">gtousd),</span> <span class="hl kwd">ts</span><span class="hl std">(blackfcast1</span><span class="hl opt">$</span><span class="hl std">mean,</span> <span class="hl kwc">start</span> <span class="hl std">=</span> <span class="hl num">117</span><span class="hl std">))</span>
<span class="hl kwd">colnames</span><span class="hl std">(most_precise)</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Original&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;HybridIn&quot;</span><span class="hl std">)</span>
<span class="hl kwd">autoplot</span><span class="hl std">(most_precise)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/unnamed-chunk-7-1.png" title="plot of chunk unnamed-chunk-7" alt="plot of chunk unnamed-chunk-7" class="plot" /></div></div>

<p>We have an almost perfect forecast of what gold is going to be about 3 months out. This is only for the black market gold prices and one could argue that we imputed a fair amount of values. Next, we are going to look at each region and determine the exact same thing here but we will make it into a function for ease of use. </p>

</body>
</html>
